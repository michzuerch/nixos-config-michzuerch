


-- SECTION: theme

-- Base16 theme
require('base16-colorscheme').setup({["base00"] = "#282828",
["base01"] = "#3c3836",
["base02"] = "#504945",
["base03"] = "#665c54",
["base04"] = "#bdae93",
["base05"] = "#d5c4a1",
["base06"] = "#ebdbb2",
["base07"] = "#fbf1c7",
["base08"] = "#fb4934",
["base09"] = "#fe8019",
["base0A"] = "#fabd2f",
["base0B"] = "#b8bb26",
["base0C"] = "#8ec07c",
["base0D"] = "#83a598",
["base0E"] = "#d3869b",
["base0F"] = "#d65d0e"})




-- SECTION: globalsScript
vim.g.editorconfig = true
vim.g.mapleader = " "
vim.g.maplocalleader = ","
vim.g.markdown_fenced_languages = {"ts=typescript"}


-- SECTION: basic






vim.o.smartcase = true
vim.o.ignorecase = true





-- SECTION: optionsScript
vim.o.autoindent = true
vim.o.backup = false
vim.o.cmdheight = 1
vim.o.cursorlineopt = "line"
vim.o.encoding = "utf-8"
vim.o.errorbells = false
vim.o.expandtab = true
vim.o.foldcolumn = "1"
vim.o.foldenable = true
vim.o.foldlevel = 99
vim.o.foldlevelstart = 99
vim.o.hidden = true
vim.o.mouse = "nvi"
vim.o.mousemoveevent = true
vim.o.number = true
vim.o.relativenumber = true
vim.o.shiftwidth = 8
vim.o.signcolumn = "yes"
vim.o.spell = true
vim.o.spelllang = "en"
vim.o.splitbelow = true
vim.o.splitright = true
vim.o.swapfile = false
vim.o.tabstop = 8
vim.o.termguicolors = true
vim.o.tm = 500
vim.o.updatetime = 300
vim.o.visualbell = false
vim.o.wrap = false
vim.o.writebackup = false


-- SECTION: lazyConfigs
require('lz.n').load({{"cheatsheet-nvim",
["after"] = function()
  
  require("cheatsheet").setup({})
  
end
,
["before"] = function()
  require('lz.n').trigger_load('telescope')
end
,
["cmd"] = {"Cheatsheet",
"CheatsheetEdit"}},
{"cmp-buffer",
["after"] = function()
  
  
  local path = vim.fn.globpath(vim.o.packpath, 'pack/*/opt/cmp-buffer')
require("rtp_nvim").source_after_plugin_dir(path)

end
,
["lazy"] = true},
{"cmp-nvim-lsp",
["after"] = function()
  
  
  local path = vim.fn.globpath(vim.o.packpath, 'pack/*/opt/cmp-nvim-lsp')
require("rtp_nvim").source_after_plugin_dir(path)

end
,
["lazy"] = true},
{"cmp-path",
["after"] = function()
  
  
  local path = vim.fn.globpath(vim.o.packpath, 'pack/*/opt/cmp-path')
require("rtp_nvim").source_after_plugin_dir(path)

end
,
["lazy"] = true},
{"cmp-treesitter",
["after"] = function()
  
  
  local path = vim.fn.globpath(vim.o.packpath, 'pack/*/opt/cmp-treesitter')
require("rtp_nvim").source_after_plugin_dir(path)

end
,
["lazy"] = true},
{"comment-nvim",
["after"] = function()
  
  require("Comment").setup({["mappings"] = {["basic"] = false,
["extra"] = false}})
  
end
,
["keys"] = {{"gc",
"<Plug>(comment_toggle_linewise)",
["desc"] = "Toggle line comment",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gb",
"<Plug>(comment_toggle_blockwise)",
["desc"] = "Toggle block comment",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gcc",
function()
  return vim.api.nvim_get_vvar('count') == 0 and '<Plug>(comment_toggle_linewise_current)'
          or '<Plug>(comment_toggle_linewise_count)'
end
,
["desc"] = "Toggle current line comment",
["expr"] = true,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gbc",
function()
  return vim.api.nvim_get_vvar('count') == 0 and '<Plug>(comment_toggle_blockwise_current)'
          or '<Plug>(comment_toggle_blockwise_count)'
end
,
["desc"] = "Toggle current block comment",
["expr"] = true,
["mode"] = {"n"},
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gc",
"<Plug>(comment_toggle_linewise_visual)",
["desc"] = "Toggle selected comment",
["expr"] = false,
["mode"] = "x",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gb",
"<Plug>(comment_toggle_blockwise_visual)",
["desc"] = "Toggle selected block",
["expr"] = false,
["mode"] = "x",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"diffview-nvim",
["after"] = function()
  
  require("diffview").setup({})
  
end
,
["cmd"] = {"DiffviewClose",
"DiffviewFileHistory",
"DiffviewFocusFiles",
"DiffviewLog",
"DiffviewOpen",
"DiffviewRefresh",
"DiffviewToggleFiles"}},
{"fidget-nvim",
["after"] = function()
  
  require("fidget").setup({["integration"] = {["nvim-tree"] = {["enable"] = false},
["xcodebuild-nvim"] = {["enable"] = true}},
["logger"] = {["float_precision"] = 0.010000,
["level"] = vim.log.levels.WARN,
["max_size"] = 10000,
["path"] = string.format("%s/fidget.nvim.log", vim.fn.stdpath("cache"))
},
["notification"] = {["configs"] = {["default"] = require('fidget.notification').default_config},
["filter"] = vim.log.levels.INFO,
["history_size"] = 128,
["override_vim_notify"] = false,
["poll_rate"] = 10,
["redirect"] = function(msg, level, opts)
  if opts and opts.on_open then
    return require("fidget.integration.nvim-notify").delegate(msg, level, opts)
  end
end
,
["view"] = {["group_separator"] = "---",
["group_separator_hl"] = "Comment",
["icon_separator"] = " ",
["render_message"] = function(msg, cnt)
  return cnt == 1 and msg or string.format("(%dx) %s", cnt, msg)
end
,
["stack_upwards"] = true},
["window"] = {["align"] = "bottom",
["border"] = "rounded",
["max_height"] = 0,
["max_width"] = 0,
["normal_hl"] = "Comment",
["relative"] = "editor",
["winblend"] = 100,
["x_padding"] = 1,
["y_padding"] = 0,
["zindex"] = 45}},
["progress"] = {["display"] = {["done_icon"] = "‚úì",
["done_style"] = "Constant",
["done_ttl"] = 3,
["format_annote"] = function(msg) return msg.title end
,
["format_group_name"] = function(group) return tostring(group) end
,
["format_message"] = require("fidget.progress.display").default_format_message
,
["group_style"] = "Title",
["icon_style"] = "Question",
["overrides"] = {},
["priority"] = 30,
["progress_icon"] = {["pattern"] = "dots",
["period"] = 1},
["progress_style"] = "WarningMsg",
["progress_ttl"] = 99999,
["render_limit"] = 16,
["skip_history"] = true},
["ignore"] = {},
["ignore_done_already"] = false,
["ignore_empty_message"] = false,
["lsp"] = {["log_handler"] = false,
["progress_ringbuf_size"] = 100},
["notification_group"] = function(msg)
  return msg.lsp_client.name
end
,
["poll_rate"] = 0,
["suppress_on_insert"] = false}})
  
end
,
["event"] = "LspAttach"},
{"gitlinker-nvim",
["after"] = function()
  
  require("gitlinker").setup({})
  
end
,
["cmd"] = {"GitLink"}},
{"hunk-nvim",
["after"] = function()
  
  require("hunk").setup({})
  
end
},
{"icon-picker-nvim",
["after"] = function()
  
  require("icon-picker").setup({["disable_legacy_commands"] = true})
  
end
,
["cmd"] = {"IconPickerInsert",
"IconPickerNormal",
"IconPickerYank"}},
{"lspsaga-nvim",
["after"] = function()
  
  require("lspsaga").setup({["border_style"] = "rounded"})
  
end
,
["event"] = {"LspAttach"}},
{"multicursors-nvim",
["after"] = function()
  
  require("multicursors").setup({["DEBUG_MODE"] = false,
["create_commands"] = true,
["generate_hints"] = {["config"] = {["max_hint_length"] = 25},
["extend"] = true,
["insert"] = true,
["normal"] = true},
["hint_config"] = {["float_opts"] = {["border"] = "none"},
["position"] = "bottom"},
["mode_keys"] = {["append"] = "a",
["change"] = "c",
["extend"] = "e",
["insert"] = "i"},
["nowait"] = true,
["updatetime"] = 50})
  
end
,
["cmd"] = {"MCstart",
"MCvisual",
"MCclear",
"MCpattern",
"MCvisualPattern",
"MCunderCursor"},
["event"] = {"DeferredUIEnter"},
["keys"] = {{"<leader>mcs",
":MCstart<cr>",
["desc"] = "Create a selection for selected text or word under the cursor [multicursors.nvim]",
["expr"] = false,
["mode"] = {"v",
"n"},
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>mcp",
":MCpattern<cr>",
["desc"] = "Create a selection for pattern entered [multicursors.nvim]",
["expr"] = false,
["mode"] = {"v",
"n"},
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"neo-tree-nvim",
["after"] = function()
  
  require("neo-tree").setup({["add_blank_line_at_top"] = false,
["auto_clean_after_session_restore"] = false,
["default_source"] = "filesystem",
["enable_cursor_hijack"] = false,
["enable_diagnostics"] = true,
["enable_git_status"] = true,
["enable_modified_markers"] = true,
["enable_opened_markers"] = true,
["enable_refresh_on_write"] = true,
["filesystem"] = {["hijack_netrw_behavior"] = "open_default"},
["git_status_async"] = false,
["hide_root_node"] = false,
["log_level"] = "info",
["log_to_file"] = false,
["open_files_do_not_replace_types"] = {"terminal",
"Trouble",
"qf",
"edgy"},
["open_files_in_last_window"] = true,
["retain_hidden_root_indent"] = false})
  
end
,
["cmd"] = {"Neotree"}},
{"neogit",
["after"] = function()
  
  require("neogit").setup({})
  
end
,
["cmd"] = {"Neogit"},
["keys"] = {{"<leader>gs",
"<Cmd>Neogit<CR>",
["desc"] = "Git Status [Neogit]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>gc",
"<Cmd>Neogit commit<CR>",
["desc"] = "Git Commit [Neogit]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>gp",
"<Cmd>Neogit pull<CR>",
["desc"] = "Git pull [Neogit]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>gP",
"<Cmd>Neogit push<CR>",
["desc"] = "Git push [Neogit]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"nvim-cmp",
["after"] = function()
  
  
  
local cmp = require("cmp")

local kinds = require("cmp.types").lsp.CompletionItemKind
local deprio = function(kind)
  return function(e1, e2)
    if e1:get_kind() == kind then
      return false
    end
    if e2:get_kind() == kind then
      return true
    end
    return nil
  end
end

cmp.setup({["completion"] = {["completeopt"] = "menu,menuone,noinsert"},
["formatting"] = {["format"] = require("lspkind").cmp_format({["before"] = function(entry, vim_item)
  vim_item.menu = ({["nvim_lsp"] = "[LSP]",
["treesitter"] = "[Treesitter]"})[entry.source.name]
  return vim_item
end
,
["mode"] = "symbol_text"})
},
["mapping"] = {["<C-Space>"] = cmp.mapping.complete(),
["<C-d>"] = cmp.mapping.scroll_docs(-4),
["<C-e>"] = cmp.mapping.abort(),
["<C-f>"] = cmp.mapping.scroll_docs(4),
["<CR>"] = cmp.mapping.confirm({ select = true }),
["<S-Tab>"] = cmp.mapping(function(fallback)
  if cmp.visible() then
    cmp.select_prev_item()
    
  else
    fallback()
  end
end)
,
["<Tab>"] = cmp.mapping(function(fallback)
  local has_words_before = function()
    local line, col = unpack(vim.api.nvim_win_get_cursor(0))
    return col ~= 0 and vim.api.nvim_buf_get_lines(0, line - 1, line, true)[1]:sub(col, col):match("%s") == nil
  end

  if cmp.visible() then
    cmp.select_next_item()
    
  elseif has_words_before() then
    cmp.complete()
  else
    fallback()
  end
end)
},
["sorting"] = {["comparators"] = {deprio(kinds.Text),
deprio(kinds.Snippet),
cmp.config.compare.offset,
cmp.config.compare.exact,
cmp.config.compare.score,
cmp.config.compare.kind,
cmp.config.compare.length,
cmp.config.compare.sort_text}},
["sources"] = {{["name"] = "nvim_lsp"},
{["name"] = "treesitter"}},
["window"] = {["completion"] = {["border"] = "rounded"},
["documentation"] = {["border"] = "rounded"}}})

require('lz.n').trigger_load("cmp-buffer")
require('lz.n').trigger_load("cmp-path")
require('lz.n').trigger_load("cmp-treesitter")
require('lz.n').trigger_load("cmp-nvim-lsp")

end
,
["event"] = {"InsertEnter",
"CmdlineEnter"}},
{"nvim-dap-ui",
["after"] = function()
  
  require("dapui").setup({})
  
end
,
["keys"] = {{"<leader>du",
function() require('dapui').toggle() end,
["desc"] = "Toggle DAP-UI",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"nvim-surround",
["after"] = function()
  
  require("nvim-surround").setup({["keymaps"] = {["change"] = "gzr",
["change_line"] = "gZR",
["delete"] = "gzd",
["insert"] = "<C-g>z",
["insert_line"] = "<C-g>Z",
["normal"] = "gz",
["normal_cur"] = "gZ",
["normal_cur_line"] = "gZZ",
["normal_line"] = "gzz",
["visual"] = "gz",
["visual_line"] = "gZ"}})
  
end
,
["event"] = {"BufReadPre",
"BufNewFile"},
["keys"] = {{"<C-g>z",
["expr"] = false,
["mode"] = "i",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<C-g>Z",
["expr"] = false,
["mode"] = "i",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gz",
["expr"] = false,
["mode"] = "x",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gZ",
["expr"] = false,
["mode"] = "x",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gz",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gZ",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gzz",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gZZ",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gzd",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gzr",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"gZR",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"nvim-ufo",
["after"] = function()
  
  require("ufo").setup({})
  
end
},
{"smart-splits",
["after"] = function()
  
  require("smart-splits").setup({})
  
end
,
["event"] = {"DeferredUIEnter"},
["keys"] = {{"<A-h>",
function() require('smart-splits').resize_left() end,
["desc"] = "Resize Window/Pane Left",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<A-j>",
function() require('smart-splits').resize_down() end,
["desc"] = "Resize Window/Pane Down",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<A-k>",
function() require('smart-splits').resize_up() end,
["desc"] = "Resize Window/Pane Up",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<A-l>",
function() require('smart-splits').resize_right() end,
["desc"] = "Resize Window/Pane Right",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<C-h>",
function() require('smart-splits').move_cursor_left() end,
["desc"] = "Focus Window/Pane on the Left",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<C-j>",
function() require('smart-splits').move_cursor_down() end,
["desc"] = "Focus Window/Pane Below",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<C-k>",
function() require('smart-splits').move_cursor_up() end,
["desc"] = "Focus Window/Pane Above",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<C-l>",
function() require('smart-splits').move_cursor_right() end,
["desc"] = "Focus Window/Pane on the Right",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<C-\\>",
function() require('smart-splits').move_cursor_previous() end,
["desc"] = "Focus Previous Window/Pane",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader><leader>h",
function() require('smart-splits').swap_buf_left() end,
["desc"] = "Swap Buffer Left",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader><leader>j",
function() require('smart-splits').swap_buf_down() end,
["desc"] = "Swap Buffer Down",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader><leader>k",
function() require('smart-splits').swap_buf_up() end,
["desc"] = "Swap Buffer Up",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader><leader>l",
function() require('smart-splits').swap_buf_right() end,
["desc"] = "Swap Buffer Right",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"telescope",
["after"] = function()
  
  require("telescope").setup({["defaults"] = {["color_devicons"] = false,
["entry_prefix"] = "  ",
["extensions"] = {},
["file_ignore_patterns"] = {"node_modules",
"%.git/",
"dist/",
"build/",
"target/",
"result/"},
["initial_mode"] = "insert",
["layout_config"] = {["height"] = 0.800000,
["horizontal"] = {["preview_width"] = 0.550000,
["prompt_position"] = "top"},
["preview_cutoff"] = 120,
["vertical"] = {["mirror"] = false},
["width"] = 0.800000},
["layout_strategy"] = "horizontal",
["path_display"] = {"absolute"},
["pickers"] = {["find_command"] = {"/nix/store/qb9d3fma2z9xgf57bj44ygxak6s1bvw9-fd-10.3.0/bin/fd"}},
["prompt_prefix"] = "  Ôê¢   ",
["selection_caret"] = "  ",
["selection_strategy"] = "reset",
["set_env"] = {["COLORTERM"] = "truecolor"},
["sorting_strategy"] = "ascending",
["vimgrep_arguments"] = {"/nix/store/0qh46n4bqwci1dli1bjqkavvzmdw87x3-ripgrep-15.1.0/bin/rg",
"--color=never",
"--no-heading",
"--with-filename",
"--line-number",
"--column",
"--smart-case",
"--hidden",
"--no-ignore"},
["winblend"] = 0},
["pickers"] = {["find_files"] = {["find_command"] = {"/nix/store/qb9d3fma2z9xgf57bj44ygxak6s1bvw9-fd-10.3.0/bin/fd",
"--type=file"}}}})
  local telescope = require("telescope")
telescope.load_extension('noice')
telescope.load_extension('notify')
telescope.load_extension('projects')


end
,
["before"] = function()
  vim.g.loaded_telescope = nil

end
,
["cmd"] = {"Telescope"},
["keys"] = {{"<leader>ff",
"<cmd>Telescope find_files<CR>",
["desc"] = "Find files [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fg",
"<cmd>Telescope live_grep<CR>",
["desc"] = "Live grep [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fb",
"<cmd>Telescope buffers<CR>",
["desc"] = "Buffers [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fh",
"<cmd>Telescope help_tags<CR>",
["desc"] = "Help tags [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>ft",
"<cmd>Telescope<CR>",
["desc"] = "Open [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fr",
"<cmd>Telescope resume<CR>",
["desc"] = "Resume (previous search) [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fvf",
"<cmd>Telescope git_files<CR>",
["desc"] = "Git files [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fvcw",
"<cmd>Telescope git_commits<CR>",
["desc"] = "Git commits [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fvcb",
"<cmd>Telescope git_bcommits<CR>",
["desc"] = "Git buffer commits [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fvb",
"<cmd>Telescope git_branches<CR>",
["desc"] = "Git branches [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fvs",
"<cmd>Telescope git_status<CR>",
["desc"] = "Git status [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fvx",
"<cmd>Telescope git_stash<CR>",
["desc"] = "Git stash [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>flsb",
"<cmd>Telescope lsp_document_symbols<CR>",
["desc"] = "LSP Document Symbols [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>flsw",
"<cmd>Telescope lsp_workspace_symbols<CR>",
["desc"] = "LSP Workspace Symbols [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>flr",
"<cmd>Telescope lsp_references<CR>",
["desc"] = "LSP References [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fli",
"<cmd>Telescope lsp_implementations<CR>",
["desc"] = "LSP Implementations [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>flD",
"<cmd>Telescope lsp_definitions<CR>",
["desc"] = "LSP Definitions [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>flt",
"<cmd>Telescope lsp_type_definitions<CR>",
["desc"] = "LSP Type Definitions [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fld",
"<cmd>Telescope diagnostics<CR>",
["desc"] = "Diagnostics [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fs",
"<cmd>Telescope treesitter<CR>",
["desc"] = "Treesitter [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>fp",
"<cmd>Telescope projects<CR>",
["desc"] = "Find projects [Telescope]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"toggleterm-nvim",
["after"] = function()
  
  require("toggleterm").setup({["direction"] = "horizontal",
["enable_winbar"] = false,
["size"] = function(term)
  if term.direction == "horizontal" then
    return 15
  elseif term.direction == "vertical" then
    return vim.o.columns * 0.4
  end
end
,
["winbar"] = {["enabled"] = true,
["name_formatter"] = function(term)
  return term.name
end
}})
  local terminal = require 'toggleterm.terminal'
local lazygit = terminal.Terminal:new({
  cmd = '/nix/store/y2b0jghhic94ahrb2bncmfjqk2391ji5-lazygit-0.58.0/bin/lazygit',
  direction = 'float',
  hidden = true,
  on_open = function(term)
    vim.cmd("startinsert!")
  end
})

vim.keymap.set('n', "<leader>gg", function() lazygit:toggle() end, {silent = true, noremap = true, desc = 'Open lazygit [toggleterm]'})

end
,
["cmd"] = {"ToggleTerm",
"ToggleTermSendCurrentLine",
"ToggleTermSendVisualLines",
"ToggleTermSendVisualSelection",
"ToggleTermSetName",
"ToggleTermToggleAll"},
["keys"] = {{"<c-t>",
"<Cmd>execute v:count . \"ToggleTerm\"<CR>",
["desc"] = "Toggle terminal",
["expr"] = false,
["mode"] = {"n",
"t"},
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>gg",
["desc"] = "Open lazygit [toggleterm]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"trouble",
["after"] = function()
  
  require("trouble").setup({})
  
end
,
["cmd"] = "Trouble",
["keys"] = {{"<leader>lwd",
"<cmd>Trouble toggle diagnostics<CR>",
["desc"] = "Workspace diagnostics [trouble]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>ld",
"<cmd>Trouble toggle diagnostics filter.buf=0<CR>",
["desc"] = "Document diagnostics [trouble]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>lr",
"<cmd>Trouble toggle lsp_references<CR>",
["desc"] = "LSP References [trouble]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>xq",
"<cmd>Trouble toggle quickfix<CR>",
["desc"] = "QuickFix [trouble]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>xl",
"<cmd>Trouble toggle loclist<CR>",
["desc"] = "LOCList [trouble]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>xs",
"<cmd>Trouble toggle symbols<CR>",
["desc"] = "Symbols [trouble]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}},
{"yazi.nvim",
["after"] = function()
  
  require("yazi").setup({["open_for_directories"] = false})
  
end
,
["event"] = {"BufAdd",
"VimEnter"},
["keys"] = {{"<leader>-",
"<cmd>Yazi<CR>",
["desc"] = "Open yazi at the current file [yazi.nvim]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<leader>cw",
"<cmd>Yazi cwd<CR>",
["desc"] = "Open the file manager in nvim's working directory [yazi.nvim]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false},
{"<c-up>",
"<cmd>Yazi toggle<CR>",
["desc"] = "Resume the last yazi session [yazi.nvim]",
["expr"] = false,
["mode"] = "n",
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false}}}})
require('lzn-auto-require').enable()


-- SECTION: pluginConfigs
-- SECTION: alpha
require('alpha').setup(require'alpha.themes.dashboard'.config)


-- SECTION: autopairs
require('nvim-autopairs').setup({})


-- SECTION: breadcrumbs

local navic = require("nvim-navic")
require("nvim-navic").setup {
  highlight = true
}


local navbuddy = require("nvim-navbuddy")
local actions = require("nvim-navbuddy.actions")
navbuddy.setup {["icons"] = {["Array"] = "Û∞Ö™ ",
["Boolean"] = "‚ó© ",
["Class"] = "Û∞åó ",
["Constant"] = "Û∞èø ",
["Constructor"] = "Ôê• ",
["Enum"] = "Û∞ïò",
["EnumMember"] = "Û∞ïò ",
["Event"] = "ÔÉß ",
["Field"] = "Óúñ ",
["File"] = "Û∞àô ",
["Function"] = "Û∞äï ",
["Interface"] = "Û∞ïò",
["Key"] = "Û∞åã ",
["Method"] = "Û∞Üß ",
["Module"] = "Óò§ ",
["Namespace"] = "Û∞åó ",
["Null"] = "Û∞ü¢ ",
["Number"] = "Û∞é† ",
["Object"] = "Û∞Ö© ",
["Operator"] = "Û∞Üï ",
["Package"] = "Óò§ ",
["Property"] = "Óûõ ",
["String"] = "Ôî´ ",
["Struct"] = "Û∞åó ",
["TypeParameter"] = "Û∞äÑ ",
["Variable"] = "Û∞Üß "},
["lsp"] = {["auto_attach"] = true},
["mappings"] = {["0"] = actions.root(),
["<C-s>"] = actions.hsplit(),
["<C-v>"] = actions.vsplit(),
["<enter>"] = actions.select(),
["<esc>"] = actions.close(),
["A"] = actions.append_scope(),
["F"] = actions.fold_delete(),
["I"] = actions.insert_scope(),
["J"] = actions.move_down(),
["K"] = actions.move_up(),
["V"] = actions.visual_scope(),
["Y"] = actions.yank_scope(),
["a"] = actions.append_name(),
["c"] = actions.comment(),
["d"] = actions.delete(),
["f"] = actions.fold_create(),
["g?"] = actions.help(),
["h"] = actions.parent(),
["i"] = actions.insert_name(),
["j"] = actions.next_sibling(),
["k"] = actions.previous_sibling(),
["l"] = actions.children(),
["r"] = actions.rename(),
["s"] = actions.toggle_preview(),
["t"] = actions.telescope({
  layout_strategy = "horizontal",
  layout_config = {
    height = 0.60,
    width = 0.75,
    prompt_position = "top",
    preview_width = 0.50
  },
}),
["v"] = actions.visual_name(),
["y"] = actions.yank_name()},
["node_markers"] = {["enable"] = false,
["icons"] = {["branch"] = " Ôë†",
["leaf"] = "  ",
["leaf_selected"] = " ‚Üí "}},
["source_buffer"] = {["followNode"] = true,
["highlight"] = true,
["reorient"] = "smart"},
["useDefaultMappings"] = true,
["window"] = {["border"] = "rounded",
["sections"] = {["left"] = {["border"] = "rounded"},
["mid"] = {["border"] = "rounded"},
["right"] = {["border"] = "rounded",
["preview"] = "leaf"}}}}



-- SECTION: ccc
local ccc = require("ccc")
ccc.setup({["alpha_show"] = "hide",
["convert"] = {{ccc.picker.hex,
ccc.output.css_hsl},
{ccc.picker.css_rgb,
ccc.output.css_hsl},
{ccc.picker.css_hsl,
ccc.output.hex}},
["highlighter"] = {["auto_enable"] = true,
["filetypes"] = colorPickerFts,
["lsp"] = true,
["max_byte"] = 2097152},
["inputs"] = {ccc.input.hsl},
["mappings"] = {["H"] = ccc.mapping.decrease10,
["L"] = ccc.mapping.increase10,
["q"] = ccc.mapping.quit},
["outputs"] = {ccc.output.css_hsl,
ccc.output.css_rgb,
ccc.output.hex},
["pickers"] = {ccc.picker.hex,
ccc.picker.css_rgb,
ccc.picker.css_hsl,
ccc.picker.ansi_escape { meaning1 = "bold", }},
["recognize"] = {["output"] = true}})


-- SECTION: codewindow
local codewindow = require('codewindow')
codewindow.setup({
  exclude_filetypes = { 'NvimTree', 'orgagenda', 'Alpha'},
})


-- SECTION: colorizer
require('colorizer').setup({["filetypes"] = {},
["user_default_options"] = {}})


-- SECTION: conform-nvim
require("conform").setup({["default_format_opts"] = {["lsp_format"] = "fallback"},
["format_after_save"] = function()
  if not vim.g.formatsave or vim.b.disableFormatSave then
    return
  else
    return {["lsp_format"] = "fallback"}
  end
end
,
["format_on_save"] = function()
  if not vim.g.formatsave or vim.b.disableFormatSave then
    return
  else
    return {lsp_format = "fallback", timeout_ms = 500}
  end
end
,
["formatters"] = {["alejandra"] = {["command"] = "/nix/store/n6sb7vhz902kk24z9qppr6ndmiv8hzqi-alejandra-4.0.0/bin/alejandra"},
["deno_fmt"] = {["command"] = "/nix/store/67dia2211bw3jdmp9gyn0nq9r5pmwi43-deno-2.6.3/bin/deno"},
["gofmt"] = {["command"] = "/nix/store/60z37432vmgkg54krwr1z057bqwp7583-go-1.25.5/bin/gofmt"},
["jsonfmt"] = {["args"] = {"-w",
"-"},
["command"] = "/nix/store/6gdgj4s8p7z35acdnpnxasqimnmlj4qd-jsonfmt-0.5.2/bin/jsonfmt"},
["prettier"] = {["command"] = "/nix/store/8sa75mbvbn3kxicggyyjggmkigvzddks-prettier-3.6.2/bin/prettier",
["options"] = {["ft_parsers"] = {["astro"] = "astro"}},
["prepend_args"] = {"--plugin=/nix/store/y6c75igimjriwgf1djn4hwx38kp9fpzj-prettier-plugin-astro-v0.14.1/index.js"}},
["rustfmt"] = {["command"] = "/nix/store/i1zl6150nc77vryj6n9razki0l5bzxv5-rustfmt-1.91.1/bin/rustfmt"},
["shfmt"] = {["command"] = "/nix/store/c3bgrcwq2735ybl5zw68n9nqgwaa0yrj-shfmt-3.12.0/bin/shfmt"},
["sqlfluff"] = {["append_args"] = {"--dialect=ansi"},
["command"] = "/nix/store/yzlxkq0j1hwl5gsrdmkb3s787qr7mkj7-sqlfluff-3.5.0/bin/sqlfluff"},
["stylua"] = {["command"] = "/nix/store/r3gyc06qnh09sw77pwk5fn7mxyf7g5yj-stylua-2.3.1/bin/stylua"}},
["formatters_by_ft"] = {["astro"] = {"prettier"},
["css"] = {"prettier"},
["go"] = {"gofmt"},
["javascript"] = {"prettier"},
["json"] = {"jsonfmt"},
["lua"] = {"stylua"},
["markdown"] = {"deno_fmt"},
["nix"] = {"alejandra"},
["rust"] = {"rustfmt"},
["sh"] = {"shfmt"},
["sql"] = {"sqlfluff"},
["svelte"] = {"prettier"},
["typescript"] = {"prettier"},
["typescriptreact"] = {"prettier"}},
["setupOpts"] = {["formatters"] = {["prettier"] = {["command"] = "/nix/store/8sa75mbvbn3kxicggyyjggmkigvzddks-prettier-3.6.2/bin/prettier"}}}})


-- SECTION: cursorline
require("cinnamon").setup({["keymaps"] = {["basic"] = false,
["extra"] = false},
["options"] = {["count_only"] = false,
["mode"] = "cursor"}})


-- SECTION: fastaction
require('fastaction').setup({["popup"] = {["border"] = "rounded"},
["register_ui_select"] = true})

-- SECTION: git-conflict
require('git-conflict').setup({["default_mappings"] = false})


-- SECTION: gitsigns
require('gitsigns').setup({})


-- SECTION: highlight-undo
require("highlight-undo").setup({["duration"] = 500})


-- SECTION: html-autotag
require('nvim-ts-autotag').setup()


-- SECTION: image-nvim
require("image").setup(
  {["backend"] = "ueberzug",
["editorOnlyRenderWhenFocused"] = false,
["hijackFilePatterns"] = {"*.png",
"*.jpg",
"*.jpeg",
"*.gif",
"*.webp"},
["integrations"] = {["markdown"] = {["clearInInsertMode"] = false,
["downloadRemoteImages"] = false,
["enable"] = true,
["filetypes"] = {"markdown",
"vimwiki"},
["onlyRenderAtCursor"] = false},
["neorg"] = {["clearInInsertMode"] = false,
["downloadRemoteImages"] = false,
["enable"] = true,
["filetypes"] = {"neorg"},
["onlyRenderAtCursor"] = false}},
["maxHeightWindowPercentage"] = 50,
["windowOverlapClear"] = {["enable"] = false,
["ftIgnore"] = {"cmp_menu",
"cmp_docs",
""}}}
)

require("img-clip").setup({})


-- SECTION: indent-blankline
require("ibl").setup({["debounce"] = 200,
["indent"] = {["char"] = "‚îÇ",
["priority"] = 1,
["repeat_linebreak"] = true,
["smart_indent_cap"] = true},
["scope"] = {["char"] = "‚îÇ",
["enabled"] = true,
["exclude"] = {["language"] = {},
["node_type"] = {["*"] = {"source_file",
"program"},
["lua"] = {"chunk"},
["python"] = {"module"}}},
["include"] = {["node_type"] = {}},
["injected_languages"] = true,
["priority"] = 1024,
["show_end"] = false,
["show_exact_scope"] = false,
["show_start"] = false},
["viewport_buffer"] = {["max"] = 500,
["min"] = 30},
["whitespace"] = {["remove_blankline_trail"] = true}})


-- SECTION: lazydev
require("lazydev").setup({
  enabled = function(root_dir)
    return not vim.uv.fs_stat(root_dir .. "/.luarc.json")
  end,
  library = { { path = "${3rd}/luv/library", words = { "vim%.uv" } } },
})


-- SECTION: lightbulb
local nvim_lightbulb = require("nvim-lightbulb")
nvim_lightbulb.setup({})
vim.api.nvim_create_autocmd({"CursorHold",
"CursorHoldI"}, {
  pattern = "*",
  callback = function()
    nvim_lightbulb.update_lightbulb()
  end,
})



-- SECTION: lsp-setup
vim.g.formatsave = true;

local attach_keymaps = function(client, bufnr)
  vim.keymap.set('n', "<leader>lgD", vim.lsp.buf.declaration, {buffer=bufnr, noremap=true, silent=true, desc="Go to declaration"})
  vim.keymap.set('n', "<leader>lgd", vim.lsp.buf.definition, {buffer=bufnr, noremap=true, silent=true, desc="Go to definition"})
  vim.keymap.set('n', "<leader>lgt", vim.lsp.buf.type_definition, {buffer=bufnr, noremap=true, silent=true, desc="Go to type"})
  vim.keymap.set('n', "<leader>lgi", vim.lsp.buf.implementation, {buffer=bufnr, noremap=true, silent=true, desc="List implementations"})
  vim.keymap.set('n', "<leader>lgr", vim.lsp.buf.references, {buffer=bufnr, noremap=true, silent=true, desc="List references"})
  vim.keymap.set('n', "<leader>lgn", vim.diagnostic.goto_next, {buffer=bufnr, noremap=true, silent=true, desc="Go to next diagnostic"})
  vim.keymap.set('n', "<leader>lgp", vim.diagnostic.goto_prev, {buffer=bufnr, noremap=true, silent=true, desc="Go to previous diagnostic"})
  vim.keymap.set('n', "<leader>le", vim.diagnostic.open_float, {buffer=bufnr, noremap=true, silent=true, desc="Open diagnostic float"})
  vim.keymap.set('n', "<leader>lH", vim.lsp.buf.document_highlight, {buffer=bufnr, noremap=true, silent=true, desc="Document highlight"})
  vim.keymap.set('n', "<leader>lS", vim.lsp.buf.document_symbol, {buffer=bufnr, noremap=true, silent=true, desc="List document symbols"})
  vim.keymap.set('n', "<leader>lwa", vim.lsp.buf.add_workspace_folder, {buffer=bufnr, noremap=true, silent=true, desc="Add workspace folder"})
  vim.keymap.set('n', "<leader>lwr", vim.lsp.buf.remove_workspace_folder, {buffer=bufnr, noremap=true, silent=true, desc="Remove workspace folder"})
  vim.keymap.set('n', "<leader>lwl", function() vim.notify(vim.inspect(vim.lsp.buf.list_workspace_folders())) end, {buffer=bufnr, noremap=true, silent=true, desc="List workspace folders"})
  vim.keymap.set('n', "<leader>lws", vim.lsp.buf.workspace_symbol, {buffer=bufnr, noremap=true, silent=true, desc="List workspace symbols"})
  vim.keymap.set('n', "<leader>lh", vim.lsp.buf.hover, {buffer=bufnr, noremap=true, silent=true, desc="Trigger hover"})
  vim.keymap.set('n', "<leader>ls", vim.lsp.buf.signature_help, {buffer=bufnr, noremap=true, silent=true, desc="Signature help"})
  vim.keymap.set('n', "<leader>ln", vim.lsp.buf.rename, {buffer=bufnr, noremap=true, silent=true, desc="Rename symbol"})
  vim.keymap.set('n', "<leader>la", vim.lsp.buf.code_action, {buffer=bufnr, noremap=true, silent=true, desc="Code action"})
  vim.keymap.set('n', "<leader>lf", vim.lsp.buf.format, {buffer=bufnr, noremap=true, silent=true, desc="Format"})
  vim.keymap.set('n', "<leader>ltf", function() vim.b.disableFormatSave = not vim.b.disableFormatSave end, {buffer=bufnr, noremap=true, silent=true, desc="Toggle format on save"})
end

local navic = require("nvim-navic")
default_on_attach = function(client, bufnr)
  attach_keymaps(client, bufnr)
  -- let navic attach to buffers
if client.server_capabilities.documentSymbolProvider then
  navic.attach(client, bufnr)
end

end

local capabilities = vim.lsp.protocol.make_client_capabilities()
-- TODO(horriblename): migrate to vim.lsp.config['*']
-- HACK: copied from cmp-nvim-lsp. If we ever lazy load lspconfig we
-- should re-evaluate whether we can just use `default_capabilities`
capabilities = {
  textDocument = {
    completion = {
      dynamicRegistration = false,
      completionItem = {
        snippetSupport = true,
        commitCharactersSupport = true,
        deprecatedSupport = true,
        preselectSupport = true,
        tagSupport = {
          valueSet = {
            1, -- Deprecated
          }
        },
        insertReplaceSupport = true,
        resolveSupport = {
          properties = {
            "documentation",
            "detail",
            "additionalTextEdits",
            "sortText",
            "filterText",
            "insertText",
            "textEdit",
            "insertTextFormat",
            "insertTextMode",
          },
        },
        insertTextModeSupport = {
          valueSet = {
            1, -- asIs
            2, -- adjustIndentation
          }
        },
        labelDetailsSupport = true,
      },
      contextSupport = true,
      insertTextMode = 1,
      completionList = {
        itemDefaults = {
          'commitCharacters',
          'editRange',
          'insertTextFormat',
          'insertTextMode',
          'data',
        }
      }
    },
  },
}





-- SECTION: lsp-signature
-- Enable lsp signature viewer
require("lsp_signature").setup({["bind"] = true,
["handler_opts"] = {["border"] = "rounded"}})


-- SECTION: lualine
local lualine = require('lualine')
lualine.setup {["extensions"] = {"neo-tree"},
["inactive_sections"] = {["lualine_a"] = {},
["lualine_b"] = {},
["lualine_c"] = {'filename'},
["lualine_x"] = {'location'},
["lualine_y"] = {},
["lualine_z"] = {}},
["options"] = {["always_divide_middle"] = true,
["component_separators"] = {["left"] = "",
["right"] = ""},
["globalstatus"] = true,
["icons_enabled"] = true,
["refresh"] = {["statusline"] = 1000,
["tabline"] = 1000,
["winbar"] = 1000},
["section_separators"] = {["left"] = "",
["right"] = ""},
["theme"] = "base16"},
["sections"] = {["lualine_a"] = {{
  "mode",
  icons_enabled = true,
  separator = {
    left = '‚ñé',
    right = 'ÓÇº'
  },
}
,
{
  "",
  draw_empty = true,
  separator = { left = 'ÓÇ∫', right = 'ÓÇº' }
}
},
["lualine_b"] = {{
  "filetype",
  colored = true,
  icon_only = true,
  icon = { align = 'left' }
}
,
{
  "filename",
  symbols = {modified = 'ÔÅÑ ', readonly = 'Ó©µ '},
  separator = {right = 'ÓÇº'}
}
,
{
  "",
  draw_empty = true,
  separator = { left = 'ÓÇ∫', right = 'ÓÇº' }
}
},
["lualine_c"] = {{
  "diff",
  colored = false,
  diff_color = {
    -- Same color values as the general color option can be used here.
    added    = 'DiffAdd',    -- Changes the diff's added color
    modified = 'DiffChange', -- Changes the diff's modified color
    removed  = 'DiffDelete', -- Changes the diff's removed color you
  },
  symbols = {added = '+', modified = '~', removed = '-'}, -- Changes the diff symbols
  separator = {right = 'ÓÇº'}
}
},
["lualine_x"] = {{
  -- Lsp server name
  function()
    local buf_ft = vim.bo.filetype
    local excluded_buf_ft = { toggleterm = true, NvimTree = true, ["neo-tree"] = true, TelescopePrompt = true }

    if excluded_buf_ft[buf_ft] then
      return ""
      end

    local bufnr = vim.api.nvim_get_current_buf()
    local clients = vim.lsp.get_clients({ bufnr = bufnr })

    if vim.tbl_isempty(clients) then
      return "No Active LSP"
    end

    local active_clients = {}
    for _, client in ipairs(clients) do
      table.insert(active_clients, client.name)
    end

    return table.concat(active_clients, ", ")
  end,
  icon = 'ÔÇÖ ',
  separator = {left = 'ÓÇæ'},
}
,
{
  "diagnostics",
  sources = {'nvim_lsp', 'nvim_diagnostic', 'nvim_diagnostic', 'vim_lsp', 'coc'},
  symbols = {error = 'Û∞Öô  ', warn = 'ÔÅ±  ', info = 'ÔÅö  ', hint = 'Û∞åµ '},
  colored = true,
  update_in_insert = false,
  always_visible = false,
  diagnostics_color = {
    color_error = { fg = 'red' },
    color_warn = { fg = 'yellow' },
    color_info = { fg = 'cyan' },
  },
}
},
["lualine_y"] = {{
  "",
  draw_empty = true,
  separator = { left = 'ÓÇæ', right = 'ÓÇ∏' }
}
,
{
  'searchcount',
  maxcount = 999,
  timeout = 120,
  separator = {left = 'ÓÇæ'}
}
,
{
  "branch",
  icon = 'Óú• ‚Ä¢',
  separator = {left = 'ÓÇæ'}
}
},
["lualine_z"] = {{
  "",
  draw_empty = true,
  separator = { left = 'ÓÇæ', right = 'ÓÇ∏' }
}
,
{
  "progress",
  separator = {left = 'ÓÇæ'}
}
,
{"location"}
,
{
  "fileformat",
  color = {fg='black'},
  symbols = {
    unix = 'Óúí', -- e712
    dos = 'Óúè',  -- e70f
    mac = 'Óúë',  -- e711
  }
}
}},
["winbar"] = {["lualine_c"] = {{"navic",
draw_empty = true}}}}


-- SECTION: markview-nvim
require("markview").setup({})


-- SECTION: mind-nvim
require'mind'.setup()


-- SECTION: modes-nvim
require('modes').setup({["colors"] = {["copy"] = "#f5c359",
["delete"] = "#c75c6a",
["insert"] = "#78ccc5",
["visual"] = "#9745be"},
["line_opacity"] = {["visual"] = 0.000000},
["setCursorline"] = false})


-- SECTION: neo-tree
vim.api.nvim_create_autocmd("BufEnter", {
  group = vim.api.nvim_create_augroup("load_neo_tree", {}),
  desc = "Loads neo-tree when opening a directory",
  callback = function(args)
    local stats = vim.uv.fs_stat(args.file)

    if not stats or stats.type ~= "directory" then
      return
    end

    require("lz.n").trigger_load("neo-tree-nvim")

    return true
  end,
})


-- SECTION: noice-nvim
require("noice").setup({["format"] = {["cmdline"] = {["icon"] = "ÔÅî",
["lang"] = "vim",
["pattern"] = "^:"},
["filter"] = {["icon"] = "ÔÑ†",
["lang"] = "bash",
["pattern"] = "^:%s*!"},
["help"] = {["icon"] = "Û∞ãñ",
["pattern"] = "^:%s*he?l?p?%s+"},
["lua"] = {["icon"] = "Óò†",
["lang"] = "lua",
["pattern"] = "^:%s*lua%s+"},
["search_down"] = {["icon"] = "ÔÄÇ ÔÑÉ",
["kind"] = "search",
["lang"] = "regex",
["pattern"] = "^/"},
["search_up"] = {["icon"] = "ÔÄÇ ÔÑÇ",
["kind"] = "search",
["lang"] = "regex",
["pattern"] = "^%?"}},
["lsp"] = {["override"] = {["cmp.entry.get_documentation"] = true,
["vim.lsp.util.convert_input_to_markdown_lines"] = true,
["vim.lsp.util.stylize_markdown"] = true},
["signature"] = {["enabled"] = false}},
["presets"] = {["bottom_search"] = true,
["command_palette"] = true,
["inc_rename"] = false,
["long_message_to_split"] = true,
["lsp_doc_border"] = true},
["routes"] = {{["filter"] = {["event"] = "msg_show",
["find"] = "written",
["kind"] = ""},
["opts"] = {["skip"] = true}}}})


-- SECTION: nvim-cursorline
require("nvim-cursorline").setup({["cursorline"] = {["enable"] = false,
["number"] = false,
["timeout"] = 1000},
["cursorword"] = {["enable"] = false,
["hl"] = {["underline"] = true},
["min_length"] = 3,
["timeout"] = 1000}})


-- SECTION: nvim-dap
local dap = require("dap")
vim.fn.sign_define("DapBreakpoint", { text = "üõë", texthl = "ErrorMsg", linehl = "", numhl = "" })


-- SECTION: nvim-dap-go
require('dap-go').setup {
  delve = {
    path = '/nix/store/rwycbvzs0i16qccffjpn644z9zi9b7ar-delve-1.26.0/bin/dlv',
  }
}


-- SECTION: nvim-dap-ui
dap.listeners.after.event_initialized["dapui_config"] = function()
  require("dapui").open()
end
dap.listeners.before.event_terminated["dapui_config"] = function()
  require("dapui").close()
end
dap.listeners.before.event_exited["dapui_config"] = function()
  require("dapui").close()
end


-- SECTION: nvim-docs-view
require("docs-view").setup {["height"] = 10,
["position"] = "right",
["update_mode"] = "auto",
["width"] = 60}


-- SECTION: nvim-lint
require("lint").linters_by_ft = {["astro"] = {"eslint_d"},
["html"] = {"htmlhint"},
["lua"] = {"luacheck"},
["markdown"] = {"markdownlint-cli2"},
["nix"] = {"deadnix",
"statix"},
["sh"] = {"shellcheck"},
["sql"] = {"sqlfluff"},
["svelte"] = {"eslint_d"},
["typescript"] = {"eslint_d"},
["typescriptreact"] = {"eslint_d"}}

local linters = require("lint").linters
local nvf_linters = {["deadnix"] = {["cmd"] = "/nix/store/6mga6m2shwhl22zwpnlf1q2ldw3v9zsm-deadnix-1.3.1/bin/deadnix"},
["eslint_d"] = {["cmd"] = "/nix/store/djw5nl5qfirdi2h4a3bcwj919rpxfci7-eslint_d-14.3.0/bin/eslint_d",
["required_files"] = {"eslint.config.js",
"eslint.config.mjs",
".eslintrc",
".eslintrc.json",
".eslintrc.js",
".eslintrc.yml",
"eslint.config.js",
"eslint.config.mjs",
".eslintrc",
".eslintrc.json",
".eslintrc.js",
".eslintrc.yml",
"eslint.config.js",
"eslint.config.mjs",
".eslintrc",
".eslintrc.cjs",
".eslintrc.json",
".eslintrc.js",
".eslintrc.yml"}},
["htmlhint"] = {["cmd"] = "/nix/store/lbb5q4x72x5mq2z1amqy0qjhhlq78vn6-htmlhint-1.7.1/bin/htmlhint"},
["luacheck"] = {["cmd"] = "/nix/store/qf23gxz9nl0fcw1dxhab1ja2xzx6ycm3-luajit2.1-luacheck-1.2.0-1/bin/luacheck"},
["markdownlint-cli2"] = {["cmd"] = "/nix/store/9jblciw3m08wzihaa2g7ysq739qc83p7-markdownlint-cli2-0.18.1/bin/markdownlint-cli2"},
["shellcheck"] = {["cmd"] = "/nix/store/l78bkxxy8z3bpw24qlay1lrbx9719w8l-shellcheck-0.11.0-bin/bin/shellcheck"},
["sqlfluff"] = {["args"] = {"lint",
"--format=json",
"--dialect=ansi"},
["cmd"] = "/nix/store/yzlxkq0j1hwl5gsrdmkb3s787qr7mkj7-sqlfluff-3.5.0/bin/sqlfluff"},
["statix"] = {["cmd"] = "/nix/store/cfvf3xhwgh9zjicyr3npdh3296c1i1zs-statix-0.5.8/bin/statix"}}
for linter, config in pairs(nvf_linters) do
  if linters[linter] == nil then
    linters[linter] = config
  else
    for key, val in pairs(config) do
      linters[linter][key] = val
    end
  end
end

nvf_lint = function(buf)
  local ft = vim.api.nvim_get_option_value("filetype", { buf = buf })
  local linters = require("lint").linters
  local linters_from_ft = require("lint").linters_by_ft[ft]

  -- if no linter is configured for this filetype, stops linting
  if linters_from_ft == nil then return end

  for _, name in ipairs(linters_from_ft) do
    local linter = linters[name]
    assert(linter, 'Linter with name `' .. name .. '` not available')

    if type(linter) == "function" then
      linter = linter()
    end
    -- for require("lint").lint() to work, linter.name must be set
    linter.name = linter.name or name
    local cwd = linter.required_files

    -- if no configuration files are configured, lint
    if cwd == nil then
      require("lint").lint(linter)
    else
      -- if configuration files are configured and present in the project, lint
      for _, fn in ipairs(cwd) do
        local path = vim.fs.joinpath(linter.cwd or vim.fn.getcwd(), fn);
        if vim.uv.fs_stat(path) then
          require("lint").lint(linter)
          break
        end
      end
    end
  end
end



-- SECTION: nvim-notify
local notify = require("notify")
notify.setup({["background_colour"] = "NotifyBackground",
["icons"] = {["DEBUG"] = "ÔÜà",
["ERROR"] = "ÔÅó",
["INFO"] = "ÔÅö",
["TRACE"] = "ÔÖå",
["WARN"] = "ÔÅ±"},
["position"] = "top_right",
["render"] = "compact",
["stages"] = "fade_in_slide_out",
["timeout"] = 1000})
vim.notify = notify.notify


-- SECTION: nvim-scrollbar
require("scrollbar").setup({["excluded_filetypes"] = {"prompt",
"TelescopePrompt",
"noice",
"NvimTree",
"neo-tree",
"alpha",
"notify",
"Navbuddy",
"fastaction_popup"}})


-- SECTION: nvim-session-manager
local Path = require('plenary.path')
local sm = require('session_manager.config')
require('session_manager').setup({["autoload_mode"] = sm.AutoloadMode.LastSession,
["autosave_ignore_buftypes"] = {},
["autosave_ignore_dirs"] = {},
["autosave_ignore_filetypes"] = {"gitcommit"},
["autosave_ignore_not_normal"] = true,
["autosave_last_session"] = true,
["autosave_only_in_session"] = false,
["colon_replacer"] = "++",
["max_path_length"] = 80,
["path_replacer"] = "__"})


-- SECTION: nvim-web-devicons
require("nvim-web-devicons").setup({["color_icons"] = true,
["override"] = {}})


-- SECTION: nvimBufferline
require("bufferline").setup({["highlights"] = {},
["options"] = {["always_show_bufferline"] = true,
["auto_toggle_bufferline"] = true,
["buffer_close_icon"] = " Û∞Öñ ",
["close_command"] = function(bufnum)
  require("bufdelete").bufdelete(bufnum, false)
end
,
["close_icon"] = " ÔÄç ",
["color_icons"] = true,
["diagnostics"] = "nvim_lsp",
["diagnostics_indicator"] = function(count, level, diagnostics_dict, context)
  local s = " "
    for e, n in pairs(diagnostics_dict) do
      local sym = e == "error" and " ÔÅó  "
        or (e == "warning" and " ÔÅ±  " or " ÔÑ© " )
      s = s .. n .. sym
    end
  return s
end
,
["diagnostics_update_in_insert"] = false,
["duplicates_across_groups"] = true,
["enforce_regular_tabs"] = false,
["hover"] = {["delay"] = 200,
["enabled"] = true,
["reveal"] = {"close"}},
["indicator"] = {["style"] = "underline"},
["left_mouse_command"] = "buffer %d",
["left_trunc_marker"] = "ÔÇ®",
["max_name_length"] = 18,
["max_prefix_length"] = 15,
["mode"] = "buffers",
["modified_icon"] = "‚óè ",
["move_wraps_at_ends"] = false,
["numbers"] = function(opts)
  return string.format('%s¬∑%s', opts.raise(opts.id), opts.lower(opts.ordinal))
end
,
["offsets"] = {{["filetype"] = "NvimTree",
["highlight"] = "Directory",
["separator"] = true,
["text"] = "File Explorer"},
{["filetype"] = "neo-tree",
["highlight"] = "Directory",
["separator"] = true,
["text"] = "File Explorer"},
{["filetype"] = "snacks_layout_box",
["highlight"] = "Directory",
["separator"] = true,
["text"] = "File Explorer"}},
["persist_buffer_sort"] = true,
["right_mouse_command"] = "vertical sbuffer %d",
["right_trunc_marker"] = "ÔÇ©",
["separator_style"] = "thin",
["show_buffer_close_icons"] = true,
["show_buffer_icons"] = true,
["show_close_icon"] = true,
["show_duplicate_prefix"] = true,
["show_tab_indicators"] = true,
["sort_by"] = "extension",
["style_preset"] = require('bufferline').style_preset.default,
["tab_size"] = 18,
["themable"] = true,
["truncate_names"] = true}})


-- SECTION: oil-nvim
require("oil").setup({["win_options"] = {["signcolumn"] = "yes:2"}});


-- SECTION: oil-git-status-nvim
require("oil-git-status").setup({})


-- SECTION: otter-nvim
-- Enable otter diagnostics viewer
require("otter").setup({["buffers"] = {["write_to_disk"] = false},
["handle_leading_whitespace"] = false,
["lsp"] = {["diagnostic_update_event"] = {"BufWritePost"}},
["strip_wrapping_quote_characters"] = {"'",
"\"",
"`"}})


-- SECTION: project-nvim
require('project_nvim').setup({["detection_methods"] = {"lsp",
"pattern"},
["exclude_dirs"] = {},
["lsp_ignored"] = {},
["manual_mode"] = true,
["patterns"] = {".git",
"_darcs",
".hg",
".bzr",
".svn",
"Makefile",
"package.json",
"flake.nix",
"cargo.toml"},
["scope_chdir"] = "global",
["show_hidden"] = false,
["silent_chdir"] = true})


-- SECTION: rust-crates
require("crates").setup({["completion"] = {["crates"] = {["enabled"] = true,
["lsp"] = {["actions"] = true,
["completion"] = true,
["enabled"] = true,
["hover"] = true},
["max_results"] = 8,
["min_chars"] = 3}},
["lsp"] = {["actions"] = true,
["completion"] = true,
["enabled"] = true,
["hover"] = true}})


-- SECTION: rustaceanvim
vim.g.rustaceanvim = {
-- LSP
tools = {
  hover_actions = {
    replace_builtin_hover = false
  },
},
server = {
  cmd = {"/nix/store/x0rzz773d6pjr3zyp6753d93zw37yjkl-rust-analyzer-2025-12-29/bin/rust-analyzer"},
  default_settings = {
    ['rust-analyzer'] = {
  cargo = {allFeature = true},
  checkOnSave = true,
  procMacro = {
    enable = true,
  },
},

  },
  on_attach = function(client, bufnr)
    default_on_attach(client, bufnr)
    local opts = { noremap=true, silent=true, buffer = bufnr }
    vim.keymap.set("n", "<localleader>rr", ":RustLsp runnables<CR>", opts)
    vim.keymap.set("n", "<localleader>rp", ":RustLsp parentModule<CR>", opts)
    vim.keymap.set("n", "<localleader>rm", ":RustLsp expandMacro<CR>", opts)
    vim.keymap.set("n", "<localleader>rc", ":RustLsp openCargo", opts)
    vim.keymap.set("n", "<localleader>rg", ":RustLsp crateGraph x11", opts)
    vim.keymap.set("n", "<localleader>rd", ":RustLsp debuggables<cr>", opts)
vim.keymap.set(
 "n", "<leader>dc",
 function()
   local dap = require("dap")
   if dap.status() == "" then
     vim.cmd "RustLsp debuggables"
   else
     dap.continue()
   end
 end,
 opts
)

  end
},


  dap = {
  adapter = {
  type = "executable",
  command = "/nix/store/0zs54jxwmjgsjm50j5rm24airkmpkbgv-lldb-21.1.7/bin/lldb-dap",
  name = "rustacean_lldb",
},
},

}


-- SECTION: smartcolumn
require("smartcolumn").setup({["colorcolumn"] = "120",
["custom_colorcolumn"] = {["go"] = {"90",
"130"},
["java"] = "130",
["nix"] = "110",
["ruby"] = "120"},
["disabled_filetypes"] = {"help",
"text",
"markdown",
"NvimTree",
"alpha"}})


-- SECTION: todo-comments
require('todo-comments').setup({["highlight"] = {["pattern"] = ".*<(KEYWORDS)(\\([^\\)]*\\))?:"},
["search"] = {["args"] = {"--color=never",
"--no-heading",
"--with-filename",
"--line-number",
"--column"},
["command"] = "/nix/store/0qh46n4bqwci1dli1bjqkavvzmdw87x3-ripgrep-15.1.0/bin/rg",
["pattern"] = "\\b(KEYWORDS)(\\([^\\)]*\\))?:"}})


-- SECTION: treesitter-autocommands
vim.api.nvim_create_augroup("nvf_treesitter", { clear = true })

-- Enable treesitter highlighting for all filetypes
vim.api.nvim_create_autocmd("FileType", {
  group = "nvf_treesitter",
  pattern = "*",
  callback = function()
    pcall(vim.treesitter.start)
  end,
})


-- Enable treesitter highlighting for all filetypes
vim.api.nvim_create_autocmd("FileType", {
  group = "nvf_treesitter",
  pattern = "*",
  callback = function()
    vim.bo.indentexpr = "v:lua.require'nvim-treesitter'.indentexpr()"
  end,
})





-- SECTION: treesitter-context
require("treesitter-context").setup({["line_numbers"] = true,
["max_lines"] = 0,
["min_window_height"] = 0,
["mode"] = "cursor",
["multiline_threshold"] = 20,
["separator"] = "-",
["trim_scope"] = "outer",
["zindex"] = 20})


-- SECTION: ts-error-translator
require("ts-error-translator").setup({["auto_override_publish_diagnostics"] = true})


-- SECTION: vim-illuminate
require('illuminate').configure({["filetypes_denylist"] = {"dirvish",
"fugitive",
"help",
"neo-tree",
"notify",
"NvimTree",
"TelescopePrompt"}})


-- SECTION: whichkey
local wk = require("which-key")
wk.setup ({["notify"] = true,
["preset"] = "modern",
["replace"] = {["<cr>"] = "RETURN",
["<leader>"] = "SPACE",
["<space>"] = "SPACE",
["<tab>"] = "TAB"},
["win"] = {["border"] = "rounded"}})
wk.add({{{ '<leader>b', desc = '+Buffer' }},
{{ '<leader>bm', desc = 'BufferLineMove' }},
{{ '<leader>bs', desc = 'BufferLineSort' }},
{{ '<leader>bsi', desc = 'BufferLineSortById' }},
{{ '<leader>f', desc = '+Telescope' }},
{{ '<leader>fl', desc = 'Telescope LSP' }},
{{ '<leader>fm', desc = 'Cellular Automaton' }},
{{ '<leader>fv', desc = 'Telescope Git' }},
{{ '<leader>fvc', desc = 'Commits' }},
{{ '<leader>g', desc = '+Git' }},
{{ '<leader>h', desc = '+Gitsigns' }},
{{ '<leader>lw', desc = '+Workspace' }},
{{ '<leader>m', desc = '+Minimap' }},
{{ '<leader>o', desc = '+Notes' }},
{{ '<leader>x', desc = '+Trouble' }}})


-- SECTION: yanky-nvim
require("yanky").setup({["ring"] = {["storage"] = "memory"}});




-- SECTION: augroups
local nvf_autogroups = {}
for _, group in ipairs({{["clear"] = true,
["enable"] = true,
["name"] = "nvf_nvim_lint"},
{["clear"] = true,
["enable"] = true,
["name"] = "nvf_lazy_file_hooks"},
{["clear"] = true,
["enable"] = true,
["name"] = "nvf_lsp"}}) do
  if group.name then
    nvf_autogroups[group.name] = { clear = group.clear }
  end
end

for group_name, options in pairs(nvf_autogroups) do
  vim.api.nvim_create_augroup(group_name, options)
end


-- SECTION: autocmds
local nvf_autocommands = {{["callback"] = function(args)
  nvf_lint(args.buf)
end
,
["enable"] = true,
["event"] = {"BufWritePost"},
["nested"] = false,
["once"] = false},
{["command"] = "doautocmd User LazyFile",
["enable"] = true,
["event"] = {"BufReadPost",
"BufNewFile",
"BufWritePre"},
["group"] = "nvf_lazy_file_hooks",
["nested"] = false,
["once"] = true},
{["callback"] = function(event)
  local bufnr = event.buf
  local client = vim.lsp.get_client_by_id(event.data.client_id)
  default_on_attach(client, bufnr)

  
end
,
["desc"] = "LSP on-attach add keybinds, enable inlay hints, and other plugin integrations",
["enable"] = true,
["event"] = {"LspAttach"},
["group"] = "nvf_lsp",
["nested"] = false,
["once"] = false}}
for _, autocmd in ipairs(nvf_autocommands) do
  vim.api.nvim_create_autocmd(
    autocmd.event,
    {
      group     = autocmd.group,
      pattern   = autocmd.pattern,
      buffer    = autocmd.buffer,
      desc      = autocmd.desc,
      callback  = autocmd.callback,
      command   = autocmd.command,
      once      = autocmd.once,
      nested    = autocmd.nested
    }
  )
end


-- SECTION: denols_handlers
local function nvf_denols_virtual_text_document_handler(uri, res, client)
  if not res then
    return nil
  end

  local lines = vim.split(res.result, '\n')
  local bufnr = vim.uri_to_bufnr(uri)

  local current_buf = vim.api.nvim_buf_get_lines(bufnr, 0, -1, false)
  if #current_buf ~= 0 then
    return nil
  end

  vim.api.nvim_buf_set_lines(bufnr, 0, -1, false, lines)
  vim.api.nvim_set_option_value('readonly', true, { buf = bufnr })
  vim.api.nvim_set_option_value('modified', false, { buf = bufnr })
  vim.api.nvim_set_option_value('modifiable', false, { buf = bufnr })
  vim.lsp.buf_attach_client(bufnr, client.id)
end

local function nvf_denols_virtual_text_document(uri, client)
  local params = {
    textDocument = {
      uri = uri,
    },
  }
  local result = client.request_sync('deno/virtualTextDocument', params)
  nvf_denols_virtual_text_document_handler(uri, result, client)
end

local function nvf_denols_handler(err, result, ctx, config)
  if not result or vim.tbl_isempty(result) then
    return nil
  end

  local client = vim.lsp.get_client_by_id(ctx.client_id)
  for _, res in pairs(result) do
    local uri = res.uri or res.targetUri
    if uri:match '^deno:' then
      nvf_denols_virtual_text_document(uri, client)
      res['uri'] = uri
      res['targetUri'] = uri
    end
  end

  vim.lsp.handlers[ctx.method](err, result, ctx, config)
end



-- SECTION: lsp-util
-- Port of nvim-lspconfig util
local util = { path = {} }

util.default_config = {
  log_level = vim.lsp.protocol.MessageType.Warning,
  message_level = vim.lsp.protocol.MessageType.Warning,
  settings = vim.empty_dict(),
  init_options = vim.empty_dict(),
  handlers = {},
  autostart = true,
  capabilities = vim.lsp.protocol.make_client_capabilities(),
}

-- global on_setup hook
util.on_setup = nil

do
  local validate = vim.validate
  local api = vim.api
  local lsp = vim.lsp
  local nvim_eleven = vim.fn.has 'nvim-0.11' == 1

  local iswin = vim.uv.os_uname().version:match 'Windows'

  local function escape_wildcards(path)
    return path:gsub('([%[%]%?%*])', '\\%1')
  end

  local function is_fs_root(path)
    if iswin then
      return path:match '^%a:$'
    else
      return path == '/'
    end
  end

  local function traverse_parents(path, cb)
    path = vim.uv.fs_realpath(path)
    local dir = path
    -- Just in case our algo is buggy, don't infinite loop.
    for _ = 1, 100 do
      dir = vim.fs.dirname(dir)
      if not dir then
        return
      end
      -- If we can't ascend further, then stop looking.
      if cb(dir, path) then
        return dir, path
      end
      if is_fs_root(dir) then
        break
      end
    end
  end

  util.root_pattern = function(...)
    local patterns = util.tbl_flatten { ... }
    return function(startpath)
      startpath = util.strip_archive_subpath(startpath)
      for _, pattern in ipairs(patterns) do
        local match = util.search_ancestors(startpath, function(path)
          for _, p in ipairs(vim.fn.glob(table.concat({ escape_wildcards(path), pattern }, '/'), true, true)) do
            if vim.uv.fs_stat(p) then
              return path
            end
          end
        end)

        if match ~= nil then
          return match
        end
      end
    end
  end

  util.root_markers_with_field = function(root_files, new_names, field, fname)
    local path = vim.fn.fnamemodify(fname, ':h')
    local found = vim.fs.find(new_names, { path = path, upward = true })

    for _, f in ipairs(found or {}) do
      -- Match the given `field`.
      for line in io.lines(f) do
        if line:find(field) then
          root_files[#root_files + 1] = vim.fs.basename(f)
          break
        end
      end
    end

    return root_files
  end

  util.insert_package_json = function(root_files, field, fname)
    return util.root_markers_with_field(root_files, { 'package.json', 'package.json5' }, field, fname)
  end

  util.strip_archive_subpath = function(path)
    -- Matches regex from zip.vim / tar.vim
    path = vim.fn.substitute(path, 'zipfile://\\(.\\{-}\\)::[^\\\\].*$', '\\1', '')
    path = vim.fn.substitute(path, 'tarfile:\\(.\\{-}\\)::.*$', '\\1', '')
    return path
  end

  util.get_typescript_server_path = function(root_dir)
    local project_roots = vim.fs.find('node_modules', { path = root_dir, upward = true, limit = math.huge })
    for _, project_root in ipairs(project_roots) do
      local typescript_path = project_root .. '/typescript'
      local stat = vim.loop.fs_stat(typescript_path)
      if stat and stat.type == 'directory' then
        return typescript_path .. '/lib'
      end
    end
    return ''
  end

  util.search_ancestors = function(startpath, func)
    if nvim_eleven then
      validate('func', func, 'function')
    end
    if func(startpath) then
      return startpath
    end
    local guard = 100
    for path in vim.fs.parents(startpath) do
      -- Prevent infinite recursion if our algorithm breaks
      guard = guard - 1
      if guard == 0 then
        return
      end

      if func(path) then
        return path
      end
    end
  end

  util.path.is_descendant = function(root, path)
    if not path then
      return false
    end

    local function cb(dir, _)
      return dir == root
    end

    local dir, _ = traverse_parents(path, cb)

    return dir == root
  end

  util.tbl_flatten = function(t)
    --- @diagnostic disable-next-line:deprecated
    return nvim_eleven and vim.iter(t):flatten(math.huge):totable() or vim.tbl_flatten(t)
  end
end


-- SECTION: lsp-servers
-- Individual LSP configurations managed by nvf.
vim.lsp.config["*"] = {["capabilities"] = capabilities,
["enable"] = true}

vim.lsp.config["astro"] = {["before_init"] = function(_, config)
  if config.init_options and config.init_options.typescript and not config.init_options.typescript.tsdk then
    config.init_options.typescript.tsdk = util.get_typescript_server_path(config.root_dir)
  end
end
,
["cmd"] = {"/nix/store/qnb7n4lxy1bnjw2asv1jc5djx8f743sr-astro-language-server-2.16.2/bin/astro-ls",
"--stdio"},
["enable"] = true,
["filetypes"] = {"astro"},
["init_options"] = {["typescript"] = {}},
["root_markers"] = {"package.json",
"tsconfig.json",
"jsconfig.json",
".git"}}

vim.lsp.config["bash-ls"] = {["cmd"] = {"/nix/store/5mk09r5xhy8xc0kbmlw0wx2wjld0dnxl-bash-language-server-5.6.0/bin/bash-language-server",
"start"},
["enable"] = true,
["filetypes"] = {"bash",
"sh"},
["root_markers"] = {".git"},
["settings"] = {["basheIde"] = {["globPattern"] = vim.env.GLOB_PATTERN or '*@(.sh|.inc|.bash|.command)'}}}

vim.lsp.config["cssls"] = {["cmd"] = {"/nix/store/5xiswi9w0vybhj0k5nfxrdh3cn03nq28-vscode-langservers-extracted-4.10.0/bin/vscode-css-language-server",
"--stdio"},
["enable"] = true,
["filetypes"] = {"css",
"scss",
"less"},
["init_options"] = {["provideFormatter"] = true},
["root_markers"] = {".git",
"package.json"},
["settings"] = {["css"] = {["validate"] = true},
["less"] = {["validate"] = true},
["scss"] = {["validate"] = true}}}

vim.lsp.config["denols"] = {["cmd"] = {"/nix/store/67dia2211bw3jdmp9gyn0nq9r5pmwi43-deno-2.6.3/bin/deno",
"lsp"},
["cmd_env"] = {["NO_COLOR"] = true},
["enable"] = true,
["filetypes"] = {"javascript",
"javascriptreact",
"javascript.jsx",
"typescript",
"typescriptreact",
"typescript.tsx"},
["handlers"] = {["textDocument/definition"] = nvf_denols_handler,
["textDocument/references"] = nvf_denols_handler,
["textDocument/typeDefinition"] = nvf_denols_handler},
["on_attach"] = function(client, bufnr)
  vim.api.nvim_buf_create_user_command(0, 'LspDenolsCache', function()
    client:exec_cmd({
      command = 'deno.cache',
      arguments = { {}, vim.uri_from_bufnr(bufnr) },
    }, { bufnr = bufnr }, function(err, _result, ctx)
      if err then
        local uri = ctx.params.arguments[2]
        vim.api.nvim_err_writeln('cache command failed for ' .. vim.uri_to_fname(uri))
      end
    end)
  end, {
    desc = 'Cache a module and all of its dependencies.',
  })
end
,
["root_markers"] = {"deno.json",
"deno.jsonc",
".git"},
["settings"] = {["deno"] = {["enable"] = true,
["suggest"] = {["imports"] = {["hosts"] = {["https://deno.land"] = true}}}}}}

vim.lsp.config["emmet-ls"] = {["cmd"] = {"/nix/store/yg2xzyccxh0l737mfrygm8b3r6wbbxh0-emmet-ls-0.4.1/bin/emmet-ls",
"--stdio"},
["enable"] = true,
["filetypes"] = {"html",
"shtml",
"htm"},
["root_markers"] = {"index.html",
".git"}}

vim.lsp.config["gopls"] = {["cmd"] = {"/nix/store/maqqwihql23dk4zrblw5fzsdf4ib4snw-gopls-0.21.0/bin/gopls"},
["enable"] = true,
["filetypes"] = {"go",
"gomod",
"gowork",
"gotmpl"},
["root_dir"] = function(bufnr, on_dir)
  local fname = vim.api.nvim_buf_get_name(bufnr)

  local function get_root(fname)
    if _G.nvf_gopls_mod_cache and fname:sub(1, #_G.nvf_gopls_mod_cache) == _G.nvf_gopls_mod_cache then
      local clients = vim.lsp.get_clients { name = 'gopls' }
      if #clients > 0 then
        return clients[#clients].config.root_dir
      end
    end
    return vim.fs.root(fname, 'go.work') or vim.fs.root(fname, 'go.mod') or vim.fs.root(fname, '.git')
  end

  -- see: https://github.com/neovim/nvim-lspconfig/issues/804
  if _G.nvf_gopls_mod_cache then
    on_dir(get_root(fname))
    return
  end
  local cmd = { 'go', 'env', 'GOMODCACHE' }
  local ok, err = pcall(vim.system, cmd, { text = true }, function(output)
    if output.code == 0 then
      if output.stdout then
        _G.nvf_gopls_mod_cache = vim.trim(output.stdout)
      end
      on_dir(get_root(fname))
    else
      vim.schedule(function()
        vim.notify(('[gopls] cmd failed with code %d: %s\n%s'):format(output.code, cmd, output.stderr))
      end)
    end
  end)
  if not ok then vim.notify(('[gopls] cmd failed: %s\n%s'):format(cmd, err)) end
end
}

vim.lsp.config["jsonls"] = {["cmd"] = {"/nix/store/5xiswi9w0vybhj0k5nfxrdh3cn03nq28-vscode-langservers-extracted-4.10.0/bin/vscode-json-language-server",
"--stdio"},
["enable"] = true,
["filetypes"] = {"json",
"jsonc"},
["init_options"] = {["provideFormatter"] = true},
["root_markers"] = {".git"}}

vim.lsp.config["lua-language-server"] = {["cmd"] = {"/nix/store/2fldvs2bv3gn3zr13pp5smz9haslw0ns-lua-language-server-3.16.1/bin/lua-language-server"},
["enable"] = true,
["filetypes"] = {"lua"},
["root_markers"] = {".luarc.json",
".luarc.jsonc",
".luacheckrc",
".stylua.toml",
"stylua.toml",
"selene.toml",
"selene.yml",
".git"}}

vim.lsp.config["marksman"] = {["cmd"] = {"/nix/store/5kr4raza7a2m23fxj262zy9rjc366s49-marksman-2025-12-13/bin/marksman",
"server"},
["enable"] = true,
["filetypes"] = {"markdown",
"markdown.mdx"},
["root_markers"] = {".marksman.toml",
".git"}}

vim.lsp.config["nil"] = {["cmd"] = {"/nix/store/r6cxyflzlpm24m6inahmldkz1ypf7xmy-nil-2025-06-13/bin/nil"},
["enable"] = true,
["filetypes"] = {"nix"},
["root_markers"] = {".git",
"flake.nix"}}

vim.lsp.config["sqls"] = {["cmd"] = {"/nix/store/gljbs3dwv3n5mj2kj9r3dra9jr4b6a91-sqls-0.2.32/bin/sqls"},
["enable"] = true,
["filetypes"] = {"sql",
"mysql"},
["on_attach"] = function(client, bufnr)
  client.server_capabilities.execute_command = true
  require'sqls'.setup{}
end
,
["root_markers"] = {"config.yml"},
["settings"] = {}}

vim.lsp.config["svelte"] = {["cmd"] = {"/nix/store/kzv2z7fxpcsdqg60xl92pawklzk8i0lg-svelte-language-server-0.17.21/bin/svelteserver",
"--stdio"},
["enable"] = true,
["filetypes"] = {"svelte"},
["on_attach"] = function(client, bufnr)
  vim.api.nvim_create_autocmd('BufWritePost', {
    pattern = { '*.js', '*.ts' },
    group = vim.api.nvim_create_augroup('svelte_js_ts_file_watch', {}),
    callback = function(ctx)
      -- internal API to sync changes that have not yet been saved to the file system
      client:notify('$/onDidChangeTsOrJsFile', { uri = ctx.match })
    end,
  })

  vim.api.nvim_buf_create_user_command(bufnr, 'LspMigrateToSvelte5', function()
    client:exec_cmd({
      command = 'migrate_to_svelte_5',
      arguments = { vim.uri_from_bufnr(bufnr) },
    })
  end, { desc = 'Migrate Component to Svelte 5 Syntax' })
end
,
["root_dir"] = function(bufnr, on_dir)
  local root_files = { 'package.json', '.git' }
  local fname = vim.api.nvim_buf_get_name(bufnr)
  -- Svelte LSP only supports file:// schema. https://github.com/sveltejs/language-tools/issues/2777
  if vim.uv.fs_stat(fname) ~= nil then
    on_dir(vim.fs.dirname(vim.fs.find(root_files, { path = fname, upward = true })[1]))
  end
end
}

vim.lsp.config["tailwindcss"] = {["before_init"] = function(_, config)
  if not config.settings then
    config.settings = {}
  end
  if not config.settings.editor then
    config.settings.editor = {}
  end
  if not config.settings.editor.tabSize then
    config.settings.editor.tabSize = vim.lsp.util.get_effective_tabstop()
  end
end
,
["cmd"] = {"/nix/store/0pdsa4jdpj7fh21y8m8n24jmkpmdxh4n-tailwindcss-language-server-0.14.28/bin/tailwindcss-language-server",
"--stdio"},
["enable"] = true,
["filetypes"] = {"aspnetcorerazor",
"astro",
"astro-markdown",
"blade",
"clojure",
"django-html",
"htmldjango",
"edge",
"eelixir",
"elixir",
"ejs",
"erb",
"eruby",
"gohtml",
"gohtmltmpl",
"haml",
"handlebars",
"hbs",
"html",
"htmlangular",
"html-eex",
"heex",
"jade",
"leaf",
"liquid",
"markdown",
"mdx",
"mustache",
"njk",
"nunjucks",
"php",
"razor",
"slim",
"twig",
"css",
"less",
"postcss",
"sass",
"scss",
"stylus",
"sugarss",
"javascript",
"javascriptreact",
"reason",
"rescript",
"typescript",
"typescriptreact",
"vue",
"svelte",
"templ"},
["root_dir"] = function(bufnr, on_dir)
  local root_files = {
    -- Generic
    'tailwind.config.js',
    'tailwind.config.cjs',
    'tailwind.config.mjs',
    'tailwind.config.ts',
    'postcss.config.js',
    'postcss.config.cjs',
    'postcss.config.mjs',
    'postcss.config.ts',
    -- Django
    'theme/static_src/tailwind.config.js',
    'theme/static_src/tailwind.config.cjs',
    'theme/static_src/tailwind.config.mjs',
    'theme/static_src/tailwind.config.ts',
    'theme/static_src/postcss.config.js',
  }
  local fname = vim.api.nvim_buf_get_name(bufnr)
  root_files = util.insert_package_json(root_files, 'tailwindcss', fname)
  root_files = util.root_markers_with_field(root_files, { 'mix.lock', 'Gemfile.lock' }, 'tailwind', fname)
  on_dir(vim.fs.dirname(vim.fs.find(root_files, { path = fname, upward = true })[1]))
end
,
["settings"] = {["tailwindCSS"] = {["classAttributes"] = {"class",
"className",
"class:list",
"classList",
"ngClass"},
["includeLanguages"] = {["eelixir"] = "html-eex",
["elixir"] = "phoenix-heex",
["eruby"] = "erb",
["heex"] = "phoenix-heex",
["htmlangular"] = "html",
["templ"] = "html"},
["lint"] = {["cssConflict"] = "warning",
["invalidApply"] = "error",
["invalidConfigPath"] = "error",
["invalidScreen"] = "error",
["invalidTailwindDirective"] = "error",
["invalidVariant"] = "error",
["recommendedVariantOrder"] = "warning"},
["validate"] = true}},
["workspace_required"] = true}

vim.lsp.config["yaml-language-server"] = {["cmd"] = {"/nix/store/wwb4qc33nc4pdsjvmbkswg1f7nkkpza2-yaml-language-server-1.19.2/bin/yaml-language-server",
"--stdio"},
["enable"] = true,
["filetypes"] = {"yaml",
"yaml.docker-compose",
"yaml.gitlab",
"yaml.helm-values"},
["root_markers"] = {".git"},
["settings"] = {["redhat"] = {["telemetry"] = {["enabled"] = false}}}}



-- Enable configured LSPs explicitly
vim.lsp.enable({"astro",
"bash-ls",
"cssls",
"denols",
"emmet-ls",
"gopls",
"jsonls",
"lua-language-server",
"marksman",
"nil",
"sqls",
"svelte",
"tailwindcss",
"yaml-language-server"})


-- SECTION: mappings
vim.keymap.set("n", "<leader>dc", require('dap').continue, {["desc"] = "Continue",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dR", require('dap').restart, {["desc"] = "Restart",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dq", require('dap').terminate, {["desc"] = "Terminate",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>d.", require('dap').run_last, {["desc"] = "Re-run Last Debug Session",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dr", require('dap').repl.toggle, {["desc"] = "Toggle Repl",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dh", require('dap.ui.widgets').hover, {["desc"] = "Hover",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>db", require('dap').toggle_breakpoint, {["desc"] = "Toggle breakpoint",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dgc", require('dap').run_to_cursor, {["desc"] = "Continue to the current cursor",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dgi", require('dap').step_into, {["desc"] = "Step into function",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dgo", require('dap').step_out, {["desc"] = "Step out of function",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dgj", require('dap').step_over, {["desc"] = "Next step",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dgk", require('dap').step_back, {["desc"] = "Step back",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dvo", require('dap').up, {["desc"] = "Go up stacktrace",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set("n", "<leader>dvi", require('dap').down, {["desc"] = "Go down stacktrace",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bc", ":BufferLinePick<CR>", {["desc"] = "Pick buffer",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bmn", ":BufferLineMoveNext<CR>", {["desc"] = "Move next buffer",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bmp", ":BufferLineMovePrev<CR>", {["desc"] = "Move previous buffer",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bn", ":BufferLineCycleNext<CR>", {["desc"] = "Next buffer",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bp", ":BufferLineCyclePrev<CR>", {["desc"] = "Previous buffer",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bsd", ":BufferLineSortByDirectory<CR>", {["desc"] = "Sort buffers by directory",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bse", ":BufferLineSortByExtension<CR>", {["desc"] = "Sort buffers by extension",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>bsi", function() require("bufferline").sort_buffers_by(function (buf_a, buf_b) return buf_a.id < buf_b.id end) end, {["desc"] = "Sort buffers by ID",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>c0", "<Plug>(git-conflict-none)", {["desc"] = "Choose None [Git-Conflict]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>cb", "<Plug>(git-conflict-both)", {["desc"] = "Choose Both [Git-Conflict]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>co", "<Plug>(git-conflict-ours)", {["desc"] = "Choose Ours [Git-Conflict]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>ct", "<Plug>(git-conflict-theirs)", {["desc"] = "Choose Theirs [Git-Conflict]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hD", function() package.loaded.gitsigns.diffthis('~') end, {["desc"] = "Diff project [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hP", package.loaded.gitsigns.preview_hunk, {["desc"] = "Preview hunk [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hR", package.loaded.gitsigns.reset_buffer, {["desc"] = "Reset buffer [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hS", package.loaded.gitsigns.stage_buffer, {["desc"] = "Stage buffer [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hb", function() package.loaded.gitsigns.blame_line{full=true} end, {["desc"] = "Blame line [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hd", package.loaded.gitsigns.diffthis, {["desc"] = "Diff this [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hr", package.loaded.gitsigns.reset_hunk, {["desc"] = "Reset hunk [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hs", package.loaded.gitsigns.stage_hunk, {["desc"] = "Stage hunk [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>hu", package.loaded.gitsigns.undo_stage_hunk, {["desc"] = "Undo stage hunk [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>lo", "<cmd>lua require'otter'.activate()<CR>", {["desc"] = "Activate LSP on Cursor Position [otter-nvim]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>lvt", "<cmd>DocsViewToggle<CR>", {["desc"] = "Open or close the docs view panel",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>lvu", "<cmd>DocsViewUpdate<CR>", {["desc"] = "Manually update the docs view panel",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>mc", require('codewindow').close_minimap, {["desc"] = "Close minimap [codewindow]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>mf", require('codewindow').toggle_focus, {["desc"] = "Toggle minimap focus [codewindow]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>mm", require('codewindow').toggle_minimap, {["desc"] = "Toggle minimap [codewindow]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>mo", require('codewindow').open_minimap, {["desc"] = "Open minimap [codewindow]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>oc", ":MindClose<CR>", {["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>om", ":MindOpenMain<CR>", {["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>op", ":MindOpenProject<CR>", {["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>sc", ":SessionManager save_current_session<CR>", {["desc"] = "Save current session",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>sd", ":SessionManager delete_session<CR>", {["desc"] = "Delete session",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>sl", ":SessionManager load_session<CR>", {["desc"] = "Load session",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>slt", ":SessionManager load_last_session<CR>", {["desc"] = "Load last session",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>tb", package.loaded.gitsigns.toggle_current_line_blame, {["desc"] = "Toggle blame [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>td", package.loaded.gitsigns.toggle_deleted, {["desc"] = "Toggle deleted [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>tdq", ":TodoQuickFix<CR>", {["desc"] = "Open Todo-s in a quickfix list",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>tds", ":TodoTelescope<CR>", {["desc"] = "Open Todo-s in telescope",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "<leader>tdt", ":TodoTrouble<CR>", {["desc"] = "Open Todo-s in Trouble",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "[c", function()
  if vim.wo.diff then return "[c" end

  vim.schedule(function() package.loaded.gitsigns.prev_hunk() end)

  return '<Ignore>'
end
, {["desc"] = "Previous hunk [Gitsigns]",
["expr"] = true,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "[x", "<Plug>(git-conflict-next-conflict)", {["desc"] = "Go to the next Conflict [Git-Conflict]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "]c", function()
  if vim.wo.diff then return "]c" end

  vim.schedule(function() package.loaded.gitsigns.next_hunk() end)

  return '<Ignore>'
end
, {["desc"] = "Next hunk [Gitsigns]",
["expr"] = true,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"n"}, "]x", "<Plug>(git-conflict-prev-conflict)", {["desc"] = "Go to the previous Conflict [Git-Conflict]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"v"}, "<leader>hr", function() package.loaded.gitsigns.reset_hunk {vim.fn.line('.'), vim.fn.line('v')} end, {["desc"] = "Reset hunk [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})
vim.keymap.set({"v"}, "<leader>hs", function() package.loaded.gitsigns.stage_hunk {vim.fn.line('.'), vim.fn.line('v')} end, {["desc"] = "Stage hunk [Gitsigns]",
["expr"] = false,
["noremap"] = true,
["nowait"] = false,
["script"] = false,
["silent"] = true,
["unique"] = false})


-- SECTION: spellcheck
-- Disable spellchecking for certain filetypes
-- as configured by `vim.spellcheck.ignoredFiletypes`
vim.api.nvim_create_augroup("nvf_autocmds", {clear = false})
vim.api.nvim_create_autocmd({ "FileType" }, {
  group = "nvf_autocmds",
  pattern = {"toggleterm"},
  callback = function()
    vim.opt_local.spell = false
  end,
})


-- SECTION: vim-dirtytalk
-- If Neovim can find (or access) the state directory
-- then append "programming" wordlist from vim-dirtytalk
-- to spelllang table. If path cannot be found, display
-- an error and avoid appending the programming words
if vim.fn.isdirectory(vim.fn.stdpath('state')) == 1 then
  vim.opt.spelllang:append("programming")
else
  vim.notify("State path does not exist: " .. state_path, vim.log.levels.ERROR)
end



